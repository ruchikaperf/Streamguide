<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STREAM Benchmark Interactive Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        h3 {
            color: #764ba2;
            font-size: 1.5em;
            margin: 25px 0 15px 0;
        }
        
        .interactive-box {
            background: linear-gradient(135deg, #f6f8fb 0%, #e9ecef 100%);
            border-left: 5px solid #667eea;
            padding: 25px;
            margin: 25px 0;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .code-block {
            background: #2d3748;
            color: #f7fafc;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }
        
        .code-block code {
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1em;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            margin: 10px 5px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }
        
        .quiz-container {
            background: #f7fafc;
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .quiz-option {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            cursor: pointer;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .quiz-option:hover {
            border-color: #667eea;
            transform: translateX(5px);
        }
        
        .quiz-option.correct {
            background: #c6f6d5;
            border-color: #38a169;
        }
        
        .quiz-option.incorrect {
            background: #fed7d7;
            border-color: #e53e3e;
        }
        
        .result-display {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid #667eea;
        }
        
        .bandwidth-calculator {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        input[type="number"], select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 5px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }
        
        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .label {
            font-weight: bold;
            margin-bottom: 8px;
            color: #2d3748;
            display: block;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
        }
        
        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .comparison-table tr:hover {
            background: #f7fafc;
        }
        
        .highlight {
            background: #fef5e7;
            padding: 3px 8px;
            border-radius: 3px;
            font-weight: bold;
            color: #d68910;
        }
        
        .tip-box {
            background: #e6fffa;
            border-left: 5px solid #38b2ac;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .warning-box {
            background: #fffaf0;
            border-left: 5px solid #ed8936;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        @media (max-width: 768px) {
            .bandwidth-calculator {
                grid-template-columns: 1fr;
            }
            
            header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ STREAM Benchmark Deep Dive</h1>
            <p>An Interactive Guide to Measuring Memory Bandwidth</p>
        </header>
        
        <div class="content">
            <div class="section">
                <h2>Why Should You Care About Memory Bandwidth?</h2>
                <p>Imagine you're at a caf√© with the world's fastest coffee maker, but the barista can only carry one cup at a time. That's your CPU waiting on memory. Modern processors are incredibly fast, but they spend most of their time <span class="highlight">starving for data</span>.</p>
                
                <div class="interactive-box">
                    <h3>Quick Quiz: Test Your Understanding</h3>
                    <div class="quiz-container" id="quiz1">
                        <p><strong>What typically bottlenecks HPC applications more?</strong></p>
                        <div class="quiz-option" onclick="checkAnswer(this, false)">A) CPU clock speed</div>
                        <div class="quiz-option" onclick="checkAnswer(this, true)">B) Memory bandwidth</div>
                        <div class="quiz-option" onclick="checkAnswer(this, false)">C) Disk I/O</div>
                        <div class="quiz-option" onclick="checkAnswer(this, false)">D) Network latency</div>
                    </div>
                </div>
                
                <p>For scientific simulations, machine learning training, and computational fluid dynamics, <strong>memory bandwidth is often the real bottleneck</strong>. STREAM helps you measure it accurately.</p>
            </div>
            
            <div class="section">
                <h2>What is STREAM?</h2>
                <p>STREAM is a simple synthetic benchmark that measures <strong>sustainable memory bandwidth</strong> using four vector operations that mimic real HPC workloads:</p>
                
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Kernel</th>
                            <th>Operation</th>
                            <th>What It Measures</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Copy</strong></td>
                            <td>A = B</td>
                            <td>Pure read/write bandwidth</td>
                        </tr>
                        <tr>
                            <td><strong>Scale</strong></td>
                            <td>A = scalar √ó B</td>
                            <td>Bandwidth + scalar multiply</td>
                        </tr>
                        <tr>
                            <td><strong>Add</strong></td>
                            <td>A = B + C</td>
                            <td>Multi-load + store operations</td>
                        </tr>
                        <tr>
                            <td><strong>Triad</strong></td>
                            <td>A = B + scalar √ó C</td>
                            <td>Most realistic workload metric</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="tip-box">
                    <strong>üí° Pro Tip:</strong> The <strong>Triad</strong> result is typically the most important number‚Äîit best represents real-world memory-bound applications.
                </div>
            </div>
            
            <div class="section">
                <h2>Running STREAM on GNU/Linux</h2>
                
                <h3>Step 1: Download and Compile</h3>
                <div class="code-block">
<code># Download STREAM
wget https://www.cs.virginia.edu/stream/FTP/Code/stream.c

# Compile with GNU GCC (optimized for your architecture)
gcc -O3 -march=native -fopenmp stream.c -o stream

# For AIX systems with GNU GCC:
gcc -O3 -mcpu=native -fopenmp stream.c -o stream

# For specific optimizations (Linux x86):
# AVX2: gcc -O3 -mavx2 -fopenmp stream.c -o stream
# AVX-512: gcc -O3 -march=native -fopenmp stream.c -o stream</code>
                </div>
                
                <div class="warning-box">
                    <strong>‚ö†Ô∏è Important:</strong> The <code>-O3</code> flag enables aggressive optimizations. Use <code>-march=native</code> on x86/x64 Linux or <code>-mcpu=native</code> on AIX POWER systems to tune for your specific CPU. Without these, you'll get misleadingly poor results!
                </div>
                
                <h3>Step 2: Set Thread Count</h3>
                <div class="code-block">
<code># Use all cores (adjust based on your system)
export OMP_NUM_THREADS=$(nproc)

# Or specify manually:
export OMP_NUM_THREADS=16</code>
                </div>
                
                <h3>Step 3: Run the Benchmark</h3>
                <div class="code-block">
<code># Basic run
./stream

# For NUMA systems, bind to specific socket:
numactl --cpunodebind=0 --membind=0 ./stream

# Multiple runs for consistency:
for i in {1..5}; do ./stream; done</code>
                </div>
                
                <div class="interactive-box">
                    <h3>üßÆ Bandwidth Calculator</h3>
                    <p>Estimate your theoretical peak bandwidth:</p>
                    <div class="bandwidth-calculator">
                        <div>
                            <label class="label">Memory Type:</label>
                            <select id="memType" onchange="calculateBandwidth()">
                                <option value="25.6">DDR4-3200 (25.6 GB/s per channel)</option>
                                <option value="38.4">DDR5-4800 (38.4 GB/s per channel)</option>
                                <option value="51.2">DDR5-6400 (51.2 GB/s per channel)</option>
                                <option value="1024">HBM2E (1024 GB/s)</option>
                            </select>
                        </div>
                        <div>
                            <label class="label">Number of Channels:</label>
                            <input type="number" id="channels" value="2" min="1" max="12" onchange="calculateBandwidth()">
                        </div>
                    </div>
                    <button onclick="calculateBandwidth()">Calculate Peak Bandwidth</button>
                    <div id="bandwidthResult" class="result-display" style="display:none;">
                        <strong>Theoretical Peak:</strong> <span id="peakValue"></span> GB/s<br>
                        <strong>Expected STREAM Triad (~80%):</strong> <span id="streamValue"></span> GB/s
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>Interpreting Your Results</h2>
                
                <h3>Sample Output:</h3>
                <div class="code-block">
<code>Function    Best Rate MB/s  Avg time     Min time     Max time
Copy:           45821.3     0.034956     0.034920     0.035012
Scale:          30547.2     0.052436     0.052378     0.052511
Add:            34285.9     0.070081     0.070005     0.070223
Triad:          34312.8     0.069982     0.069948     0.070059</code>
                </div>
                
                <div class="interactive-box">
                    <h3>Result Analyzer</h3>
                    <p>Enter your Triad result to see how it compares:</p>
                    <label class="label">Your Triad Bandwidth (MB/s):</label>
                    <input type="number" id="userTriad" placeholder="e.g., 34312">
                    <button onclick="analyzeResult()">Analyze My Result</button>
                    <div id="analysisResult" style="margin-top: 15px;"></div>
                </div>
                
                <h3>What Do Good Results Look Like?</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>System Type</th>
                            <th>Expected Triad (GB/s)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Desktop (DDR4, dual-channel)</td>
                            <td>30-45 GB/s</td>
                        </tr>
                        <tr>
                            <td>Workstation (DDR4, quad-channel)</td>
                            <td>60-100 GB/s</td>
                        </tr>
                        <tr>
                            <td>Server (DDR5, 8-channel)</td>
                            <td>200-350 GB/s</td>
                        </tr>
                        <tr>
                            <td>HPC Node (HBM2E)</td>
                            <td>800-1200 GB/s</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="section">
                <h2>Common Issues & Troubleshooting</h2>
                
                <div class="interactive-box">
                    <h3>Troubleshooting Checklist</h3>
                    <div id="troubleshoot">
                        <div class="quiz-option" onclick="toggleTip(this, 'tip1')">
                            ‚ùå Results are way lower than expected
                        </div>
                        <div id="tip1" style="display:none; padding: 15px; background: white; margin: 10px 0; border-radius: 5px;">
                            <strong>Possible fixes:</strong><br>
                            ‚Ä¢ Recompile with <code>-O3 -march=native</code> (x86) or <code>-O3 -mcpu=native</code> (AIX/POWER)<br>
                            ‚Ä¢ Check if you're using all available cores: <code>echo $OMP_NUM_THREADS</code><br>
                            ‚Ä¢ Disable CPU frequency scaling: <code>cpupower frequency-set -g performance</code><br>
                            ‚Ä¢ Check for thermal throttling
                        </div>
                        
                        <div class="quiz-option" onclick="toggleTip(this, 'tip2')">
                            ‚ùå Results vary wildly between runs
                        </div>
                        <div id="tip2" style="display:none; padding: 15px; background: white; margin: 10px 0; border-radius: 5px;">
                            <strong>Possible fixes:</strong><br>
                            ‚Ä¢ Close background applications<br>
                            ‚Ä¢ Pin threads to specific cores using <code>numactl</code><br>
                            ‚Ä¢ Increase array size in stream.c (look for STREAM_ARRAY_SIZE)<br>
                            ‚Ä¢ Run multiple times and take the best result
                        </div>
                        
                        <div class="quiz-option" onclick="toggleTip(this, 'tip3')">
                            ‚ùå Triad is lower than Copy/Scale
                        </div>
                        <div id="tip3" style="display:none; padding: 15px; background: white; margin: 10px 0; border-radius: 5px;">
                            <strong>This is normal!</strong><br>
                            Triad performs more operations (2 loads + 1 store + multiply + add), so it typically shows lower bandwidth than Copy. This represents realistic application behavior.
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>Advanced: Memory Technology Comparison</h2>
                
                <div class="interactive-box">
                    <h3>Interactive Comparison Tool</h3>
                    <button onclick="showComparison('ddr4-ddr5')">DDR4 vs DDR5</button>
                    <button onclick="showComparison('channels')">Channel Scaling</button>
                    <button onclick="showComparison('hbm')">HBM vs DDR</button>
                    
                    <div id="comparisonResult" style="margin-top: 20px;"></div>
                </div>
                
                <h3>Real-World Impact</h3>
                <p>Let's say you're running a molecular dynamics simulation that processes 100 GB of data:</p>
                <ul style="margin: 20px 0; line-height: 2;">
                    <li><strong>With 30 GB/s bandwidth:</strong> ~3.3 seconds</li>
                    <li><strong>With 100 GB/s bandwidth:</strong> ~1 second</li>
                    <li><strong>With 1000 GB/s (HBM):</strong> ~0.1 seconds</li>
                </ul>
                <p>That's a <span class="highlight">30x speedup</span> just from memory technology!</p>
            </div>
            
            <div class="section">
                <h2>Takeaways for Students & Engineers</h2>
                
                <div class="tip-box">
                    <strong>For Students:</strong><br>
                    ‚Ä¢ STREAM teaches you that <em>data movement</em> often matters more than computation<br>
                    ‚Ä¢ It's a great introduction to performance benchmarking methodology<br>
                    ‚Ä¢ Understanding memory bandwidth helps you write better optimized code
                </div>
                
                <div class="warning-box">
                    <strong>For HPC Engineers:</strong><br>
                    ‚Ä¢ Always run STREAM before deploying new hardware<br>
                    ‚Ä¢ Compare results against vendor specifications<br>
                    ‚Ä¢ Use STREAM to validate NUMA configurations and memory binding strategies<br>
                    ‚Ä¢ If your application achieves significantly less than STREAM, your bottleneck is elsewhere
                </div>
            </div>
            
            <div class="section" style="text-align: center; padding: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px;">
                <h2 style="color: white; border: none;">Ready to Benchmark?</h2>
                <p style="font-size: 1.2em; margin: 20px 0;">Now you have the knowledge to measure, interpret, and optimize memory bandwidth like a pro!</p>
                <button style="background: white; color: #667eea;" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">‚Üë Back to Top</button>
            </div>
        </div>
    </div>
    
    <script>
        function checkAnswer(element, isCorrect) {
            const options = element.parentElement.querySelectorAll('.quiz-option');
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
                if (opt === element) {
                    opt.classList.add(isCorrect ? 'correct' : 'incorrect');
                }
            });
            
            if (isCorrect) {
                element.innerHTML += ' ‚úÖ Correct! Memory bandwidth is typically the limiting factor in HPC workloads.';
            } else {
                element.innerHTML += ' ‚ùå Not quite. Think about what limits data-intensive applications.';
            }
        }
        
        function calculateBandwidth() {
            const memType = parseFloat(document.getElementById('memType').value);
            const channels = parseInt(document.getElementById('channels').value);
            const peak = memType === 1024 ? memType : memType * channels;
            const streamEstimate = peak * 0.8;
            
            document.getElementById('peakValue').textContent = peak.toFixed(1);
            document.getElementById('streamValue').textContent = streamEstimate.toFixed(1);
            document.getElementById('bandwidthResult').style.display = 'block';
        }
        
        function analyzeResult() {
            const triad = parseFloat(document.getElementById('userTriad').value);
            const result = document.getElementById('analysisResult');
            
            if (isNaN(triad) || triad <= 0) {
                result.innerHTML = '<p style="color: red;">Please enter a valid bandwidth value!</p>';
                return;
            }
            
            const triadGB = triad / 1000;
            let analysis = `<div class="result-display"><strong>Your Result: ${triadGB.toFixed(1)} GB/s</strong><br><br>`;
            
            if (triadGB < 20) {
                analysis += '‚ö†Ô∏è This is quite low. Check:<br>‚Ä¢ Compilation flags (-O3 -march=native)<br>‚Ä¢ Thread count (OMP_NUM_THREADS)<br>‚Ä¢ Background processes';
            } else if (triadGB < 50) {
                analysis += '‚úÖ Typical for desktop/laptop systems with dual-channel memory.';
            } else if (triadGB < 150) {
                analysis += 'üöÄ Good! Typical for workstation or server-class systems with more memory channels.';
            } else if (triadGB < 400) {
                analysis += 'üî• Excellent! High-performance server with many memory channels.';
            } else {
                analysis += 'üíé Outstanding! This is HPC-grade performance, possibly using HBM or many DDR5 channels.';
            }
            
            analysis += '</div>';
            result.innerHTML = analysis;
        }
        
        function toggleTip(element, tipId) {
            const tip = document.getElementById(tipId);
            tip.style.display = tip.style.display === 'none' ? 'block' : 'none';
        }
        
        function showComparison(type) {
            const result = document.getElementById('comparisonResult');
            let content = '<div class="result-display">';
            
            if (type === 'ddr4-ddr5') {
                content += `<h4>DDR4 vs DDR5 Performance</h4>
                <table class="comparison-table">
                    <tr><th>Metric</th><th>DDR4-3200</th><th>DDR5-6400</th></tr>
                    <tr><td>Bandwidth per channel</td><td>25.6 GB/s</td><td>51.2 GB/s</td></tr>
                    <tr><td>Dual-channel desktop</td><td>~40 GB/s</td><td>~80 GB/s</td></tr>
                    <tr><td>8-channel server</td><td>~180 GB/s</td><td>~350 GB/s</td></tr>
                </table>
                <p><strong>Verdict:</strong> DDR5 offers roughly 2x the bandwidth, crucial for memory-bound workloads.</p>`;
            } else if (type === 'channels') {
                content += `<h4>Impact of Memory Channels</h4>
                <p>More channels = More bandwidth (linear scaling in theory)</p>
                <table class="comparison-table">
                    <tr><th>Configuration</th><th>Channels</th><th>Expected STREAM Triad</th></tr>
                    <tr><td>Desktop</td><td>2</td><td>30-50 GB/s</td></tr>
                    <tr><td>Workstation</td><td>4</td><td>60-100 GB/s</td></tr>
                    <tr><td>Single-socket server</td><td>8</td><td>150-250 GB/s</td></tr>
                    <tr><td>Dual-socket server</td><td>16</td><td>300-450 GB/s</td></tr>
                </table>
                <p><strong>Real-world:</strong> Scaling isn't perfect due to NUMA effects and cache coherency overhead.</p>`;
            } else if (type === 'hbm') {
                content += `<h4>HBM vs DDR: Different Leagues</h4>
                <table class="comparison-table">
                    <tr><th>Technology</th><th>Bandwidth</th><th>Use Case</th></tr>
                    <tr><td>DDR4/DDR5</td><td>25-50 GB/s per channel</td><td>General purpose</td></tr>
                    <tr><td>HBM2</td><td>256-512 GB/s per stack</td><td>GPUs, accelerators</td></tr>
                    <tr><td>HBM2E/HBM3</td><td>800-1600 GB/s</td><td>High-end AI accelerators</td></tr>
                </table>
                <p><strong>Why the difference?</strong> HBM uses a completely different architecture (3D stacked memory) with thousands of parallel connections, vs DDR's sequential interface.</p>`;
            }
            
            content += '</div>';
            result.innerHTML = content;
        }
    </script>
</body>
</html>